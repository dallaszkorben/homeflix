<meta charset="UTF-8" comntent="text/html;charset=utf-8" http-equiv="Content-Type">
<!DOCTYPE html>
<html>
    <head>
        <style>
        </style>

        <script src="script/jquery/jquery-3.6.0.min.js"></script>
        <script src="test_4_thumbnail.js"></script>
        <script src="test_4_container.js"></script>

        <link rel="stylesheet" href="test_4.css">
        <link rel="icon" href="favicon.ico">

        <script>

            /*
            Substitute substrings, similar to "Hello {0}".format("world") mechanizm
            Usage: "hello {123}".format("123", world")
            */ 
            String.prototype.format = function () {
                var i = 0, args = arguments;
                return this.replace("{"+args[0]+"}", function () {
                    return typeof args[1] != 'undefined' ? args[1] : '';
                });
            };

            // String.prototype.format = function () {
            //     var i = 0, args = arguments;
            //     return this.replace(/{}/g, function () {
            //         console.log("args[0]: "+ args[0]);
            //         console.log("args[1]: "+ args[1]);
            //         return typeof args[i] != 'undefined' ? args[i++] : '';
            //     });
            // };
        
            function pathJoin(parts, sep){
                var separator = sep || '/';
                var replace   = new RegExp(separator+'{1,}', 'g');
                return parts.join(separator).replace(replace, separator);
            }

            //
            // Calculate the containers sizes
            //
           
            var desc_img_height;
            var desc_img_width;

            const description_section_height_portion = 50;
            const thumbnail_section_height_portion = 50;

            const thumbnail_section_border_width = 4;
            const thumbnail_container_block_border_width = 4;
            const thumbnail_container_border_width = 4
            const thumbnail_border_width = 7;

            const thumbnail_image_width = 300;
            const thumbnail_image_height = 300;

            const description_text_extra_font_size = 30;
            const description_text_storyline_font_size = 30;
            const description_text_credentials_font_size = 30;

            const thumbnail_container_height = thumbnail_image_height + (2*thumbnail_border_width) + (2*thumbnail_container_border_width)

            const description_text_wrapper_top = thumbnail_section_border_width;
            const description_text_wrapper_left = thumbnail_section_border_width;

            t = document.querySelector(':root');

            // Default set of the CSS
            t.style.setProperty('--description-section-height-portion', description_section_height_portion + '%');
            t.style.setProperty('--thumbnail-section-height-portion', thumbnail_section_height_portion + '%');
            t.style.setProperty('--thumbnail-section-border-width', thumbnail_section_border_width + 'px');
            t.style.setProperty('--thumbnail-container-block-border-width', thumbnail_container_block_border_width + 'px');
            t.style.setProperty('--thumbnail-container-border-width', thumbnail_container_border_width + 'px');
            t.style.setProperty('--thumbnail-border-width', thumbnail_border_width + 'px');
            t.style.setProperty('--thumbnail-container-height', thumbnail_container_height + 'px');
            t.style.setProperty('--thumbnail-image-height', thumbnail_image_height + 'px');
            t.style.setProperty('--thumbnail-image-width', thumbnail_image_width + 'px');

            t.style.setProperty('--description-text-wrapper-top', description_text_wrapper_top + 'px');
            t.style.setProperty('--description-text-wrapper-left', description_text_wrapper_left + 'px');
            t.style.setProperty('--description-text-extra-font-size', description_text_extra_font_size + 'px');
            t.style.setProperty('--description-text-storyline-font-size', description_text_storyline_font_size + 'px');
            t.style.setProperty('--description-text-credentials-font-size', description_text_credentials_font_size + 'px');

            $(document).ready(function() {                

                // Create the Thumbnail Selection Object
                oThumbnailSection = new ObjThumbnailSection()

                // Create Container 0
                let oContainer0 = new ObjThumbnailContainer();

                // Create descriptions for Container 0
                let thumbnail_0_0 = new Thumbnail();
                thumbnail_0_0.setImageSources(thumbnail_src="images/categories/movie.jpg", description_src="test_screenshot.jpg");
                thumbnail_0_0.setTitles(lang="hu", original="This is the first original title", translated="This is the first given language title", thumb="thumble 1 title");
                thumbnail_0_0.setStoryline("This is the first story<br> with multiple lines<br>divided by '<br>' tags")
                thumbnail_0_0.setCredentials(directors=["David Linch"], writers=["Philip K. Dick"], stars=["Woody Harrelson", "Jesse Eisenberg", "Emma Stone"]);
                thumbnail_0_0.setExtras(length="03:13:23", year=2013, origin=["Germany", "Sweden"], genre=["Drama"], theme=["Friendship"]);
                oContainer0.addThumbnail(1, thumbnail_0_0);

                let thumbnail_0_1 = new Thumbnail();
                thumbnail_0_1.setImageSources(thumbnail_src="images/categories/movie.jpg", description_src="images/categories/movie.jpg");
                thumbnail_0_1.setTitles("hu", original="This is the second original title", translated="This is the second given language title", thumb="thumbnail 2 title");
                thumbnail_0_1.setStoryline("This is the second story<br> with multiple lines<br>divided by '<br>' tags")
                thumbnail_0_1.setCredentials(directors=["Ruben Fleischer"], writers=["Rhett Reese", "Paul Wernick"], stars=["Woody Harrelson", "Jesse Eisenberg", "Emma Stone"]);
                thumbnail_0_1.setExtras(length="01:47:57", year=1989, origin=["Hungary", "Germany", "Australia"], genre=["Action", "Sci-fi"], theme=["War", "AI", "Life"]);
                oContainer0.addThumbnail(2, thumbnail_0_1);

                oThumbnailSection.addThumbnailContainerObject("Drama", oContainer0)
                oThumbnailSection.selectDefault();

                // -----------------------
                // Listener configurations
                // -----------------------

                //
                // Description section resize observer
                //

                // Triggered if the size of the description image DIV changed
                const resizeObserver = new ResizeObserver(entries => {

                    // Change the size of the description Image to be aligned
                    oThumbnailSection.getDescriptionContainer().resizeDescriptionSection();
                });
                const domDescSectSection = document.querySelector("#description-section");
                resizeObserver.observe(domDescSectSection);

                //
                // Arrow keyboard event listener
                //

                $(document).on('keydown',function(e){
                    function clickOnThumbnail(){
                        oThumbnailSection.clickOnThumbnail();
                    }
                    function clickOnThumbnail(){
                        oThumbnailSection.clickOnThumbnail();
                    }
                    function arrowLeft(){
                        oThumbnailSection.arrowLeft();
                    }
                    function arrowUp(){
                        oThumbnailSection.arrowUp();
                    }
                    function arrowRight(){
                        oThumbnailSection.arrowRight();
                    }
                    function arrowDown(){
                        oThumbnailSection.arrowDown();
                    }


                    var act={13:clickOnThumbnail, 32:clickOnThumbnail, 37:arrowLeft, 38:arrowUp, 39:arrowRight, 40:arrowDown};

                    if(act[e.which]) 
                        var a=new act[e.which];
                });
            });

        </script>
    </head>
    <body>

        <div id="description-section">
            <div id="description-text-div">
                <div id="description-text-wrapper">
                    <div id="description-text-title"></div>
                    <div id="description-text-extra">
                        <table border="0" id="description-text-extra-table">
                            <tr>
                                <td id="description-text-extra-table-length"></td>
                                <td id="description-text-extra-table-year"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td id="description-text-extra-table-origin"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td id="description-text-extra-table-genre"></td>
                            </tr>
                        </table>
                    </div>
                    <div id="description-text-storyline"></div>
                    <div id="description-text-credentials"></div>
                </div>
            </div>
            <div id="description-image"></div>
        </div>
    
        <div id="thumbnail-section">
            <div id="thumbnail-section-history"> > </div>           
        </div>
    </body
</html>